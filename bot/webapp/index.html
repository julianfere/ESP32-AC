<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ESP-AC Control Panel</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="app">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Cargando datos...</p>
        </div>

        <!-- Main Dashboard -->
        <div id="dashboard" class="hidden">
            <!-- Current Status Card -->
            <div class="card status-card">
                <h2>üìä Estado Actual</h2>

                <div class="status-grid">
                    <div class="status-item">
                        <span class="status-icon" id="temp-icon">üå°Ô∏è</span>
                        <div class="status-value">
                            <span id="temperature">--</span>
                            <span class="unit">¬∞C</span>
                        </div>
                        <span class="status-label">Temperatura</span>
                    </div>

                    <div class="status-item">
                        <span class="status-icon">üíß</span>
                        <div class="status-value">
                            <span id="humidity">--</span>
                            <span class="unit">%</span>
                        </div>
                        <span class="status-label">Humedad</span>
                    </div>
                </div>

                <div class="last-update">
                    √öltima actualizaci√≥n: <span id="last-update">--</span>
                </div>
            </div>

            <!-- AC Control Card -->
            <div class="card ac-control-card">
                <h2>‚ùÑÔ∏è Control de Aire Acondicionado</h2>

                <div class="ac-status">
                    <span class="ac-status-label">Estado:</span>
                    <span id="ac-status-text" class="ac-status-value">Desconocido</span>
                </div>

                <div class="ac-buttons">
                    <button id="ac-on-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">‚ùÑÔ∏è</span>
                        ENCENDER
                    </button>
                    <button id="ac-off-btn" class="btn btn-secondary btn-large">
                        <span class="btn-icon">üî•</span>
                        APAGAR
                    </button>
                </div>

                <div class="quick-timer">
                    <label>‚è±Ô∏è Apagar en:</label>
                    <div class="timer-buttons">
                        <button class="btn btn-timer" data-minutes="30">30 min</button>
                        <button class="btn btn-timer" data-minutes="60">1 hora</button>
                        <button class="btn btn-timer" data-minutes="120">2 horas</button>
                    </div>
                </div>
            </div>

            <!-- Temperature Chart Card -->
            <div class="card chart-card">
                <h2>üìà Historial de Temperatura</h2>
                <div class="chart-container">
                    <canvas id="temp-chart"></canvas>
                </div>
                <div class="chart-controls">
                    <button class="btn btn-small" data-period="hour">1 Hora</button>
                    <button class="btn btn-small active" data-period="day">24 Horas</button>
                    <button class="btn btn-small" data-period="week">7 D√≠as</button>
                </div>
            </div>

            <!-- Schedules Card -->
            <div class="card schedules-card">
                <div class="card-header">
                    <h2>üïê Programaciones</h2>
                    <button id="add-schedule-btn" class="btn btn-small btn-primary">+ Agregar</button>
                </div>

                <div id="schedules-list" class="schedules-list">
                    <!-- Schedules will be loaded here -->
                </div>
            </div>

            <!-- Alerts Configuration Card -->
            <div class="card alerts-card">
                <h2>üîî Alertas de Temperatura</h2>

                <div class="alert-toggle">
                    <label class="switch">
                        <input type="checkbox" id="alerts-enabled">
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label">Alertas Activadas</span>
                </div>

                <div id="alert-settings" class="alert-settings hidden">
                    <div class="input-group">
                        <label>üî• Temperatura Alta (¬∞C):</label>
                        <input type="number" id="alert-high" min="20" max="40" step="0.5" value="30">
                    </div>

                    <div class="input-group">
                        <label>ü•∂ Temperatura Baja (¬∞C):</label>
                        <input type="number" id="alert-low" min="10" max="30" step="0.5" value="18">
                    </div>

                    <button id="save-alerts-btn" class="btn btn-primary">Guardar Configuraci√≥n</button>
                </div>
            </div>

            <!-- Statistics Card -->
            <div class="card stats-card">
                <h2>üìä Estad√≠sticas</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">Temp. M√≠nima</span>
                        <span class="stat-value" id="stat-min-temp">--¬∞C</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Temp. M√°xima</span>
                        <span class="stat-value" id="stat-max-temp">--¬∞C</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Temp. Promedio</span>
                        <span class="stat-value" id="stat-avg-temp">--¬∞C</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Hum. Promedio</span>
                        <span class="stat-value" id="stat-hum-avg">--%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Schedule Modal -->
        <div id="schedule-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Nueva Programaci√≥n</h3>
                    <button class="close-btn" id="close-schedule-modal">&times;</button>
                </div>

                <div class="modal-body">
                    <div class="input-group">
                        <label>Nombre:</label>
                        <input type="text" id="schedule-name" placeholder="Ej: Apagar por la noche">
                    </div>

                    <div class="input-group">
                        <label>Acci√≥n:</label>
                        <select id="schedule-action">
                            <option value="on">Encender AC</option>
                            <option value="off">Apagar AC</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Hora:</label>
                        <input type="time" id="schedule-time">
                    </div>

                    <div class="input-group">
                        <label>D√≠as de la semana:</label>
                        <div class="days-selector">
                            <label class="day-checkbox">
                                <input type="checkbox" value="1"> L
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" value="2"> M
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" value="3"> M
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" value="4"> J
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" value="5"> V
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" value="6"> S
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" value="0"> D
                            </label>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button id="cancel-schedule-btn" class="btn btn-secondary">Cancelar</button>
                    <button id="save-schedule-btn" class="btn btn-primary">Guardar</button>
                </div>
            </div>
        </div>

        <!-- Error Toast -->
        <div id="toast" class="toast hidden"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="app.js"></script>
</body>

</html>